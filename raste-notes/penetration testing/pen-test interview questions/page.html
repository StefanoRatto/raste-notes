<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Pen-test interview questions</title>
</head><body>Q: Tell me a little bit about youself...<br/>
A: ... <br/>
<br/>
Q: Do you have any hobbies outside of work?<br/>
A: Pen-testing is obviously one of my hobbies, it must be to be in the industry but, besides that, triathlon, etc.<br/>
<br/>
Q: When it comes to pentesting, what is the aspect, phase, type of engagement that you enjoy the most?<br/>
A: ...<br/>
<br/>
Q: Do you have a least favorite part?<br/>
A: ...<br/>
<br/>
Q: Where do you get your news and stay up to date on exploits, vulnerabilities, etc.?<br/>
A: Twitter and pretty much any social media out there, Microsoft Security Response Center, ExploitDB, Common Vulnerabilities and Exposures (CVEÂ®) List &nbsp;<br/>
<br/>
Q: What is your biggest weakness in pentesting?<br/>
A: ...<br/>
<br/>
Q: Let"s dive in a scenario-based kind of question: starting from the external component of the pentest, which is your usual methodology?<br/>
A: First off, establish perfect communication with the customer and setup a kick-off meeting to define the scope of the pentest, objectives, limitations and what is allowed and what is not (rules of engagement). Then, I start with reconnaissance and enumeration of IP addresses and domains. Yhen I start looking for low hanging fruits, like defautl credentials and password spraying and credential stuffing on login forms<br/>
<br/>
Q: How can we confirm a blind SQL injection?<br/>
A: With time-based injection like sleep(5), sleep(10), etc.<br/>
<br/>
Q: Which are the types of SQLi?<br/>
A: In-band SQLi (Classic SQLi): Error-based SQLi and Union-based SQLi. Inferential SQLi (Blind SQLi): Boolean-based (content-based) Blind SQLi or Time-based Blind SQLi<br/>
<br/>
Q: Which are the types of XXS?<br/>
A: Reflected XSS, stored/persistent XSS and DOM-based XSS<br/>
<br/>
Q: How would you recommend the customer to mitigate SQL injection?<br/>
A: Input validation and parameterized queries<br/>
<br/>
Q: Now, let's assume you got in the internal network via that SQL injection, how do you approach the internal portion of the pentest?<br/>
A: For example on Windows networks, run Responder, Mitm6, SMB Signing (you don't need to be authenticated), BloodHound, metasploit, check for EternalBlue, SharkShell, ms08-067/Conficker, Kerberoasting (which requires an account on the network), etc. Also, see if the noise generated by the internal pentest is picked up by the security team and SIMs (as it should)<br/>
<br/>
Q: Once you get some valid credentials, how do you try to use these credentials onto the rest of the network? <br/>
A: With Impacket toolkit, CrackMapExec, etc.<br/>
<br/>
Q: Assume you get local admin on the internal network, what would you do next to penetrate further?<br/>
A: Look for GPP passwords, which are cryptographically weak, or use impersonate user tokens with Incognito, use mimikatz, hashdump, move laterally to other machines/networks, etc.<br/>
<br/>
Q: What about your approach to persistence?<br/>
A: Implement persistence via a scheduled task, registry entry, etc.<br/>
<br/>
Q: Assume now that you achieved admin on a child domain controller, how would you leverage these credentials for persistence and then how would you go after the parent domain controller?<br/>
A: I would create a Kerberos Golden Ticket or a Kerberos Silver Ticket to be more stealthy (this deas not manipulate the Kerberos TGT). As far as peristence if you have the password hash of the KRBTGT service, you can persist in the domain as long as the target company exists (the KRBTGT needs to be changed twice in order to lose persistence).<br/>
<br/>
Q: That's all for the scenario based questions. One last question on wireless pentesting: what's the difference between WPA2 Personal and WPA2 Enterprise and how would you go after those?<br/>
A: Both use a strong encryption method called AES-CCMP to encrypt data transmitted over the air. The main difference between these security modes is in the authentication stage: WPA2 Enterprise uses IEEE 802.1X, which offers enterprise-grade authentication, while WPA2 Personal uses pre-shared keys (PSK). To crack WPA2 Personal (same same for WPA), you can capture the four way handshake, during which the AP and the client use a nonce and the pre-shared key (PSK) to generate the pairwise transient key (PTK). Then use a list of possible plain text passwords or a pre-computed table of hashed passwords (Rainbow Tables) to indentify the PSK. Some of the available tools to attack WPA2 Personal are Aircrack-ng, FreeRADIUS and asleap.Attacking WPA2 Enterprise is more complex: the attack consists of spoofing the target network and provide a better signal to the client than legitimate access point, in order to perform a mitm attack between clients and network infrastructure, because currently the TLS tunnel is enough secure and not easily attackable. To make this type of attack you need to be physically proximity to the target, especially staying within the action range of enterprise access point. Some of the available tools to setup such attack are Aircrack-ng, FreeRADIUS and asleap.<br/>
<br/>
Q: Very last question on AD internal pentesting: can you mention few possible attacks/scenarions when dealing with AD environments?<br/>
A: Generally speaking, these are the most common attacks/scenarios available in a AD environment: LLMNR/NBT-NS poisoning attacks, SMB relay attacks, IPv6 DNS takeover attacks, Pass-the-password/pass-the-hash, token impersonation, Kerberoasting, Golden Ticket, PowerView/BloodHound enumeration tools, credential dumping with Mimikatz<br/>
</body></html>